# 🎯 論理回路プレイグラウンド - プロジェクト設計書

> 誰でも楽しく論理回路からCPUまで学べる、最高の教育プラットフォーム

## 📋 目次
1. [プロジェクト概要](#プロジェクト概要)
2. [コア機能](#コア機能)
3. [アーキテクチャ](#アーキテクチャ)
4. [UI/UXデザイン](#uiuxデザイン)
5. [技術スタック](#技術スタック)
6. [開発ロードマップ](#開発ロードマップ)
7. [品質基準](#品質基準)

---

## 🎯 プロジェクト概要

### ビジョン
論理回路の基礎から始まり、最終的にCPU設計まで到達できる、インタラクティブな学習プラットフォーム。「楽しさファースト」で、誰でも直感的に理解できる設計。

### コアバリュー
- **楽しさファースト**: まず触って楽しい、理解は後から
- **段階的学習**: 小さな成功体験の積み重ね
- **実用的理解**: 身近な例で「なるほど！」を提供
- **創造的発見**: 自由な実験と発見の場

### ターゲットユーザー
- プログラミング初心者
- 情報系の学生
- 電子工作に興味がある人
- 教育者

---

## 🎮 コア機能

### 3つのモード

#### 1. 学習モード 📚
段階的なチュートリアルで基礎から学習
- 全22レッスン（約3時間）
- インタラクティブな説明
- 進捗管理とバッジシステム
- 次のステップへの自動ガイド

#### 2. フリーモード 🎨
制限なしの創作空間
- 無限キャンバス
- 全ゲート利用可能
- カスタムゲート作成
- 保存・共有機能

#### 3. パズル・チャレンジモード 🧩
ゲーム感覚で実力向上
- 120問以上の問題
- 3段階ヒントシステム
- 最適化チャレンジ
- グローバルランキング

### ゲート一覧

#### 基本ゲート（70×50px）
- AND, OR, NOT
- XOR, NAND, NOR, XNOR

#### 入出力
- INPUT（スイッチ）
- OUTPUT（LED）
- CLOCK（円形、特殊形状）

#### 特殊ゲート（100×80px）
- D-FF（Dフリップフロップ）
- SR-Latch
- MUX（マルチプレクサ）
- Register（4ビット）

#### カスタムゲート
- ユーザー作成の再利用可能な回路
- アイコンと名前をカスタマイズ可能

### 主要機能
- **リアルタイムシミュレーション**: 信号の流れをアニメーション表示
- **ワンクリック配置**: ゲートを選んで即座に配置
- **自動配線**: スマートな接続補助
- **真理値表**: 自動生成と検証
- **URL共有**: 作品を簡単に共有
- **レスポンシブ対応**: PC/タブレット/スマホ対応

---

## 🏗️ アーキテクチャ

### 採用アーキテクチャ: Hybrid Feature-Domain Architecture

#### なぜこのアーキテクチャか？
- プロジェクト規模に適した複雑さ
- UI層とビジネスロジック層の明確な分離
- 既存の良い設計（entities）を活用
- 保守性と実装の容易さのバランス

### ディレクトリ構造
```
src/
├── 🎨 features/                 # 機能単位のUI層
│   ├── circuit-editor/          # 回路エディタ
│   │   ├── CircuitCanvas.tsx
│   │   ├── components/         # 機能専用コンポーネント
│   │   └── hooks/              # 機能専用フック
│   ├── learning-mode/           # 学習モード
│   └── puzzle-mode/             # パズルモード
│
├── 🔧 domain/                   # ビジネスロジック層
│   ├── entities/                # ドメインモデル
│   │   ├── gates/               # ゲートクラス
│   │   ├── circuit/             # 回路関連
│   │   └── types/               # 型定義
│   ├── services/                # ビジネスロジック
│   │   ├── GatePlacement.ts
│   │   ├── CollisionDetector.ts
│   │   └── CircuitSimulator.ts
│   └── stores/                  # 状態管理
│       └── circuitStore.ts
│
├── 🎯 shared/                   # 共有リソース
│   ├── components/              # 汎用UIコンポーネント
│   ├── hooks/                   # 汎用フック
│   └── utils/                   # ユーティリティ
│
└── 📱 app/                      # アプリケーション設定
    ├── App.tsx
    ├── providers/               # プロバイダー
    └── layouts/                 # レイアウト
```

### 状態管理
- **Zustand**: グローバル状態管理（シンプルに）
- **ローカル状態**: useState + カスタムフック
- **ビジネスロジック**: domain/servicesに集約

### 重要な設計判断
1. **統一された当たり判定**: `CollisionDetector`クラスで一元管理
2. **ゲート描画の統一**: `GateRenderer`で全ゲートを描画
3. **ピンの○─形式**: 視認性とクリック性を向上
4. **レスポンシブファースト**: モバイルでも快適な操作

---

## 🎨 UI/UXデザイン

### デザインシステム
- **ダークテーマ**: 目に優しい黒背景（#0a0a0a）
- **アクセントカラー**: 鮮やかな緑（#00ff88）
- **グラスモーフィズム**: 半透明とぼかし効果
- **アニメーション**: 滑らかな60fps

### ゲートデザイン仕様
```
基本ゲート: 70×50px、角丸8px
特殊ゲート: 100×80px、角丸8px
カスタムゲート: 100×可変高さ
CLOCK: 円形（半径40px）

ピン仕様:
- 形式: ○─（円と線）
- 円の半径: 6px
- ヒットエリア: 半径20px（モバイル30px）
- 位置:
  - INPUT出力: x=35
  - OUTPUT入力: x=-30
  - 標準ゲート: x=±45
  - 特殊ゲート: x=±60
```

### レイアウト

#### PC版（3カラム）
- 左: ツールパレット（280px）
- 中央: キャンバス（可変）
- 右: プロパティパネル（320px）

#### モバイル版
- 上部: ヘッダー（固定）
- 中央: キャンバス（全画面）
- 下部: ボトムシート型ツール

### インタラクション
- **ワンクリック配置**: ツールパレットから即座に配置
- **クリック/タップ**: 選択、接続、INPUTトグル
- **ドラッグ**: 配置済みゲートの位置調整
- **ピンチズーム**: キャンバス拡大縮小（モバイル）
- **パン**: キャンバス移動

#### 操作フロー
1. **ゲート配置**: ツールパレットのゲートをクリック → 自動的に適切な位置に配置
2. **接続**: ピンをクリック → 別のピンをクリック → 自動的にワイヤー生成
3. **位置調整**: 配置済みゲートをドラッグで移動

---

## 🛠️ 技術スタック

### フロントエンド
- **React 18**: UIフレームワーク
- **TypeScript**: 型安全性
- **Vite**: 高速ビルドツール
- **Zustand**: 状態管理
- **Jotai**: 原子的状態管理

### スタイリング
- **Tailwind CSS**: ユーティリティファースト
- **CSS Modules**: コンポーネントスコープ

### テスト
- **Vitest**: 単体テスト
- **React Testing Library**: コンポーネントテスト
- **Cypress**: E2Eテスト

### 開発ツール
- **ESLint**: コード品質
- **Prettier**: コードフォーマット
- **Husky**: Git hooks

---


---

## 📊 品質基準

### 必須達成項目
- **TypeScript**: strict mode、エラー0
- **テスト**: カバレッジ80%以上
- **ビルド**: エラー0、警告最小化
- **パフォーマンス**: 60fps維持

### パフォーマンス目標
- 初回読み込み: 3秒以内
- ゲート1000個: 30fps以上
- メモリ使用量: 200MB以下

### アクセシビリティ
- キーボード操作対応
- スクリーンリーダー対応
- 高コントラストモード

### ブラウザ対応
- Chrome/Edge（最新2バージョン）
- Firefox（最新2バージョン）
- Safari（最新2バージョン）
- モバイルブラウザ

---

## 🚀 開始方法

```bash
# 開発環境セットアップ
npm install

# 開発サーバー起動
npm run dev

# テスト実行
npm test

# ビルド
npm run build

# 品質チェック（必須）
npm run typecheck
npm run test
npm run build
```

---

## 📝 関連ドキュメント

### 必須ドキュメント
- `development/GUIDELINES.md`: 開発ルールと品質基準
- `README.md`: プロジェクト概要
- 本ドキュメント: 設計の全体像

### 参考資料
- `design/mockups/final-gate-design.html`: ゲートデザイン仕様
- `design/mockups/mobile-ui.html`: モバイルUI
- `design/mockups/desktop-ui.html`: デスクトップUI

---

## 🎯 成功の定義

### 短期目標（3ヶ月）
- 3モード実装完了（学習・フリー・パズル）
- 基本的な学習コンテンツ
- 1000人のアクティブユーザー

### 中期目標（6ヶ月）
- カスタムゲート機能
- コミュニティ機能
- 10,000人のユーザー

### 長期目標（1年）
- CPU設計チュートリアル
- 教育機関での採用
- 国際化対応

---

*このドキュメントはプロジェクトの進行に応じて更新されます。*