describe('Debug Chaos Generator', () => {
  it('should capture console logs for chaos generator', () => {
    // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£
    const logs: string[] = [];
    
    cy.on('window:before:load', (win) => {
      // ã‚ªãƒªã‚¸ãƒŠãƒ«ã®console.logã‚’ä¿å­˜
      const originalLog = win.console.log;
      
      // console.logã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰
      win.console.log = (...args) => {
        logs.push(args.map(arg => 
          typeof arg === 'object' ? JSON.stringify(arg) : String(arg)
        ).join(' '));
        originalLog.apply(win.console, args);
      };
    });
    
    // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ã
    cy.visit('/');
    
    // ã‚®ãƒ£ãƒ©ãƒªãƒ¼ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ
    cy.contains('button', 'ã‚®ãƒ£ãƒ©ãƒªãƒ¼ãƒ¢ãƒ¼ãƒ‰').click();
    
    // ã‚«ã‚ªã‚¹ç™ºç”Ÿå™¨ã‚’é¸æŠ
    cy.contains('ğŸŒ€ ã‚«ã‚ªã‚¹ç™ºç”Ÿå™¨').click();
    
    // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ•°ã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œã•ã‚Œã‚‹ã®ã‚’å¾…ã¤
    cy.wait(3000);
    
    // ãƒ­ã‚°ã‚’å‡ºåŠ›
    cy.then(() => {
      console.log('=== CAPTURED LOGS ===');
      logs.forEach(log => console.log(log));
      
      // é‡è¦ãªãƒ­ã‚°ã®ã¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
      const importantLogs = logs.filter(log => 
        log.includes('[CircuitEval]') || 
        log.includes('[CLOCK') ||
        log.includes('Evaluation order') ||
        log.includes('circular dependencies') ||
        log.includes('[EnhancedHybridEvaluator]')
      );
      
      console.log('=== IMPORTANT LOGS ===');
      importantLogs.forEach(log => console.log(log));
      
      // CLOCKãŒè©•ä¾¡ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
      const clockEvalLogs = logs.filter(log => log.includes('[CircuitEval] Evaluating clock'));
      
      // ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
      cy.writeFile('cypress/logs/chaos-generator-debug.log', logs.join('\n'));
      cy.writeFile('cypress/logs/chaos-generator-important.log', importantLogs.join('\n'));
      
      // CLOCKãŒè©•ä¾¡ã•ã‚Œã¦ã„ãªã„å ´åˆã€è©•ä¾¡é †åºã‚’ç¢ºèª
      if (clockEvalLogs.length === 0) {
        const evaluationOrderLogs = logs.filter(log => log.includes('Evaluation order:'));
        console.log('=== EVALUATION ORDER LOGS ===');
        evaluationOrderLogs.forEach(log => console.log(log));
        
        const circularLogs = logs.filter(log => log.includes('circular dependencies'));
        console.log('=== CIRCULAR DEPENDENCY LOGS ===');
        circularLogs.forEach(log => console.log(log));
      }
      
      // CLOCKãŒè©•ä¾¡ã•ã‚Œã¦ã„ã‚‹ã‹ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸€æ—¦ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
      // expect(clockEvalLogs.length, 'CLOCK should be evaluated').to.be.greaterThan(0);
    });
  });
});