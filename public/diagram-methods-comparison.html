<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>回路図表現手法の徹底比較</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/reactflow@11/dist/umd/index.js"></script>
    <link href="https://unpkg.com/reactflow@11/dist/style.css" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #1a1a1a;
            color: #e0e0e0;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .method-section {
            margin-bottom: 60px;
            background-color: #2a2a2a;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .method-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #00ff88;
            border-bottom: 2px solid #00ff88;
            padding-bottom: 10px;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .pros-cons {
            background-color: #333;
            padding: 20px;
            border-radius: 8px;
        }
        
        .pros-cons h3 {
            margin-top: 0;
            color: #00ff88;
        }
        
        .pros-cons ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .pros-cons li {
            margin-bottom: 8px;
        }
        
        .pros {
            border-left: 4px solid #4caf50;
        }
        
        .cons {
            border-left: 4px solid #f44336;
        }
        
        .demo-area {
            background-color: #1a1a1a;
            border: 2px solid #444;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            min-height: 300px;
        }
        
        .truth-table {
            margin-top: 20px;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            max-width: 400px;
        }
        
        th, td {
            border: 1px solid #444;
            padding: 8px;
            text-align: center;
        }
        
        th {
            background-color: #333;
            color: #00ff88;
        }
        
        .final-comparison {
            background-color: #2a2a2a;
            border-radius: 12px;
            padding: 30px;
            margin-top: 40px;
        }
        
        .score-table {
            width: 100%;
            margin-top: 20px;
        }
        
        .score-table th {
            background-color: #00ff88;
            color: #1a1a1a;
        }
        
        .existing-component {
            margin-top: 20px;
            padding: 20px;
            background-color: #2a2a2a;
            border-radius: 8px;
        }
        
        /* React Flow specific styles */
        .react-flow-wrapper {
            width: 100%;
            height: 400px;
            background-color: #1a1a1a;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="text-align: center; color: #00ff88; margin-bottom: 40px;">回路図表現手法の徹底比較</h1>
        
        <!-- 1. CSS + HTML方式 -->
        <div class="method-section">
            <h2 class="method-title">1. CSS + HTML方式（現在の改良版）</h2>
            
            <div class="comparison-grid">
                <div class="pros-cons pros">
                    <h3>✅ 利点</h3>
                    <ul>
                        <li>既存のコンポーネントと統一感のあるデザイン</li>
                        <li>CSSアニメーションが容易</li>
                        <li>レスポンシブ対応が簡単</li>
                        <li>Reactコンポーネントとして実装済み</li>
                        <li>既存のgate-renderersを再利用可能</li>
                    </ul>
                </div>
                
                <div class="pros-cons cons">
                    <h3>❌ 欠点</h3>
                    <ul>
                        <li>複雑なレイアウトの実装が困難</li>
                        <li>配線の描画に制限</li>
                        <li>大規模回路では管理が煩雑</li>
                        <li>印刷時の品質が劣る可能性</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-area">
                <h3>デモ: ANDゲートと真理値表</h3>
                <div style="display: flex; gap: 40px; align-items: flex-start;">
                    <div class="circuit-container" style="position: relative; width: 300px; height: 200px;">
                        <!-- ANDゲート（CSS実装） -->
                        <div style="position: absolute; left: 100px; top: 50px; width: 100px; height: 80px;">
                            <div style="position: relative; width: 100%; height: 100%; background: linear-gradient(135deg, #3a3a3a 0%, #2a2a2a 100%); border-radius: 0 40px 40px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                                <!-- 入力ピン -->
                                <div style="position: absolute; left: -10px; top: 20px; width: 20px; height: 10px; background: #666; border-radius: 5px;"></div>
                                <div style="position: absolute; left: -10px; top: 50px; width: 20px; height: 10px; background: #666; border-radius: 5px;"></div>
                                <!-- 出力ピン -->
                                <div style="position: absolute; right: -10px; top: 35px; width: 20px; height: 10px; background: #00ff88; border-radius: 5px; box-shadow: 0 0 10px #00ff88;"></div>
                                <!-- ラベル -->
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #e0e0e0; font-weight: bold; font-size: 20px;">AND</div>
                            </div>
                        </div>
                        
                        <!-- 配線 -->
                        <svg style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                            <line x1="20" y1="70" x2="100" y2="70" stroke="#666" stroke-width="2"/>
                            <line x1="20" y1="100" x2="100" y2="100" stroke="#666" stroke-width="2"/>
                            <line x1="200" y1="85" x2="280" y2="85" stroke="#00ff88" stroke-width="2" filter="url(#glow)"/>
                            <defs>
                                <filter id="glow">
                                    <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                    <feMerge>
                                        <feMergeNode in="coloredBlur"/>
                                        <feMergeNode in="SourceGraphic"/>
                                    </feMerge>
                                </filter>
                            </defs>
                        </svg>
                        
                        <!-- 入力ラベル -->
                        <div style="position: absolute; left: 5px; top: 60px; color: #888;">A</div>
                        <div style="position: absolute; left: 5px; top: 90px; color: #888;">B</div>
                        <div style="position: absolute; right: 5px; top: 75px; color: #00ff88;">Y</div>
                    </div>
                    
                    <div class="truth-table">
                        <h4>真理値表</h4>
                        <table>
                            <tr><th>A</th><th>B</th><th>Y</th></tr>
                            <tr><td>0</td><td>0</td><td>0</td></tr>
                            <tr><td>0</td><td>1</td><td>0</td></tr>
                            <tr><td>1</td><td>0</td><td>0</td></tr>
                            <tr><td>1</td><td>1</td><td style="background-color: #00ff88; color: #1a1a1a;">1</td></tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 2. Mermaid方式 -->
        <div class="method-section">
            <h2 class="method-title">2. Mermaid方式</h2>
            
            <div class="comparison-grid">
                <div class="pros-cons pros">
                    <h3>✅ 利点</h3>
                    <ul>
                        <li>テキストベースで管理が容易</li>
                        <li>バージョン管理に適している</li>
                        <li>自動レイアウト機能</li>
                        <li>学習曲線が緩やか</li>
                        <li>ドキュメント生成と統合しやすい</li>
                    </ul>
                </div>
                
                <div class="pros-cons cons">
                    <h3>❌ 欠点</h3>
                    <ul>
                        <li>回路図専用ではないため表現力に限界</li>
                        <li>ゲートの形状カスタマイズが困難</li>
                        <li>インタラクティブ性が低い</li>
                        <li>スタイルのカスタマイズに制限</li>
                        <li>論理ゲート特有の記号表現が不可能</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-area">
                <h3>デモ: ANDゲート回路</h3>
                <div class="mermaid">
                    graph LR
                        A[入力A] --> AND{AND<br/>ゲート}
                        B[入力B] --> AND
                        AND --> Y[出力Y]
                        
                        style AND fill:#3a3a3a,stroke:#00ff88,stroke-width:2px,color:#e0e0e0
                        style Y fill:#00ff88,stroke:#00ff88,stroke-width:2px,color:#1a1a1a
                </div>
            </div>
        </div>
        
        <!-- 3. React Flow方式 -->
        <div class="method-section">
            <h2 class="method-title">3. React Flow方式</h2>
            
            <div class="comparison-grid">
                <div class="pros-cons pros">
                    <h3>✅ 利点</h3>
                    <ul>
                        <li>高度にインタラクティブ（ドラッグ&ドロップ）</li>
                        <li>カスタムノードの実装が容易</li>
                        <li>ズーム・パン機能が組み込み済み</li>
                        <li>大規模回路の管理に適している</li>
                        <li>アニメーションサポート</li>
                        <li>既存のReactエコシステムと統合</li>
                    </ul>
                </div>
                
                <div class="pros-cons cons">
                    <h3>❌ 欠点</h3>
                    <ul>
                        <li>外部ライブラリへの依存</li>
                        <li>バンドルサイズが増加</li>
                        <li>学習コストが高い</li>
                        <li>静的な教育コンテンツには過剰</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-area">
                <h3>デモ: React Flowによる回路図</h3>
                <div id="reactflow-demo" class="react-flow-wrapper"></div>
            </div>
        </div>
        
        <!-- 4. Canvas API方式 -->
        <div class="method-section">
            <h2 class="method-title">4. Canvas API方式</h2>
            
            <div class="comparison-grid">
                <div class="pros-cons pros">
                    <h3>✅ 利点</h3>
                    <ul>
                        <li>ピクセル単位の正確な描画</li>
                        <li>高パフォーマンス</li>
                        <li>複雑なアニメーション可能</li>
                        <li>画像エクスポートが容易</li>
                        <li>ゲーム的な演出が可能</li>
                    </ul>
                </div>
                
                <div class="pros-cons cons">
                    <h3>❌ 欠点</h3>
                    <ul>
                        <li>インタラクティブ性の実装が複雑</li>
                        <li>テキストレンダリングの品質</li>
                        <li>レスポンシブ対応が困難</li>
                        <li>アクセシビリティの問題</li>
                        <li>SEOに不利</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-area">
                <h3>デモ: Canvas APIによるANDゲート</h3>
                <canvas id="canvas-demo" width="400" height="200" style="border: 1px solid #444;"></canvas>
            </div>
        </div>
        
        <!-- 5. 既存コンポーネントの活用 -->
        <div class="method-section">
            <h2 class="method-title">5. 既存コンポーネントの活用（推奨案）</h2>
            
            <div class="existing-component">
                <h3>現在のプロジェクトに存在するレンダラー：</h3>
                <ul>
                    <li><code>BasicGateRenderer.tsx</code> - AND, OR, NOT, XOR, NAND, NOR</li>
                    <li><code>SpecialGateRenderer.tsx</code> - CLOCK, 7SEG, LED, SWITCH</li>
                    <li><code>CustomGateRenderer.tsx</code> - カスタムゲート</li>
                    <li><code>IOGateRenderer.tsx</code> - 入出力系</li>
                </ul>
                
                <p style="margin-top: 20px; padding: 15px; background-color: #333; border-radius: 8px; border-left: 4px solid #00ff88;">
                    <strong>提案：</strong>これらの既存レンダラーを再利用し、学習モード用に静的な回路図を生成する新しいコンポーネントを作成する。
                    これにより、アプリケーション全体で一貫した見た目を保ちつつ、実装コストを最小限に抑えられる。
                </p>
            </div>
            
            <div class="comparison-grid">
                <div class="pros-cons pros">
                    <h3>✅ 利点</h3>
                    <ul>
                        <li>既存コードの再利用で開発効率が高い</li>
                        <li>アプリ全体で統一されたデザイン</li>
                        <li>メンテナンスが一元化</li>
                        <li>すでにテスト済みのコード</li>
                        <li>TypeScriptの型安全性を活用</li>
                        <li>プロジェクトの設計思想に合致</li>
                    </ul>
                </div>
                
                <div class="pros-cons cons">
                    <h3>❌ 欠点</h3>
                    <ul>
                        <li>フリーモードの実装に依存</li>
                        <li>静的表示用の調整が必要</li>
                        <li>一部のレイアウトは手動調整</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 最終比較表 -->
        <div class="final-comparison">
            <h2 style="color: #00ff88;">総合評価</h2>
            
            <table class="score-table">
                <thead>
                    <tr>
                        <th>評価項目</th>
                        <th>CSS+HTML</th>
                        <th>Mermaid</th>
                        <th>React Flow</th>
                        <th>Canvas API</th>
                        <th>既存コンポーネント</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>実装コスト</td>
                        <td>⭐⭐⭐</td>
                        <td>⭐⭐⭐⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐</td>
                        <td>⭐⭐⭐⭐⭐</td>
                    </tr>
                    <tr>
                        <td>表現力</td>
                        <td>⭐⭐⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐⭐⭐⭐⭐</td>
                        <td>⭐⭐⭐⭐⭐</td>
                        <td>⭐⭐⭐⭐</td>
                    </tr>
                    <tr>
                        <td>保守性</td>
                        <td>⭐⭐⭐</td>
                        <td>⭐⭐⭐⭐</td>
                        <td>⭐⭐⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐⭐⭐⭐⭐</td>
                    </tr>
                    <tr>
                        <td>統一性</td>
                        <td>⭐⭐⭐</td>
                        <td>⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐⭐⭐⭐⭐</td>
                    </tr>
                    <tr>
                        <td>学習モード適合性</td>
                        <td>⭐⭐⭐⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐⭐⭐</td>
                        <td>⭐⭐⭐⭐⭐</td>
                    </tr>
                    <tr style="background-color: #333;">
                        <td><strong>総合評価</strong></td>
                        <td>⭐⭐⭐</td>
                        <td>⭐⭐</td>
                        <td>⭐⭐⭐</td>
                        <td>⭐⭐⭐</td>
                        <td style="background-color: #00ff88; color: #1a1a1a;"><strong>⭐⭐⭐⭐⭐</strong></td>
                    </tr>
                </tbody>
            </table>
            
            <div style="margin-top: 30px; padding: 20px; background-color: #333; border-radius: 8px;">
                <h3 style="color: #00ff88;">結論と推奨</h3>
                <p>
                    学習モードの回路図表現には、<strong>既存のgate-renderersコンポーネントを活用する方法</strong>が最適です。
                </p>
                <ul>
                    <li>開発効率が最も高く、既存の資産を最大限活用できる</li>
                    <li>アプリケーション全体で一貫した見た目を保証</li>
                    <li>すでにテスト済みで品質が保証されている</li>
                    <li>TypeScriptの型安全性により、バグの発生を最小限に抑えられる</li>
                </ul>
                <p style="margin-top: 20px;">
                    <strong>実装方針：</strong>
                </p>
                <ol>
                    <li>既存のgate-renderersを静的表示用にラップする新しいコンポーネントを作成</li>
                    <li>回路図データをJSON形式で定義し、自動レイアウト機能を実装</li>
                    <li>真理値表は現在の美しいHTML実装を維持</li>
                    <li>必要に応じて、簡単なアニメーション効果を追加</li>
                </ol>
            </div>
        </div>
    </div>
    
    <script>
        // Mermaid初期化
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#00ff88',
                primaryBorderColor: '#00ff88',
                background: '#2a2a2a',
                mainBkg: '#2a2a2a',
                secondBkg: '#3a3a3a',
                tertiaryColor: '#1a1a1a'
            }
        });
        
        // Canvas APIデモ
        const canvas = document.getElementById('canvas-demo');
        const ctx = canvas.getContext('2d');
        
        // 背景
        ctx.fillStyle = '#1a1a1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // ANDゲートを描画
        ctx.strokeStyle = '#00ff88';
        ctx.lineWidth = 2;
        ctx.fillStyle = '#3a3a3a';
        
        // ゲート本体
        ctx.beginPath();
        ctx.moveTo(100, 50);
        ctx.lineTo(150, 50);
        ctx.arc(150, 100, 50, -Math.PI/2, Math.PI/2);
        ctx.lineTo(100, 150);
        ctx.lineTo(100, 50);
        ctx.fill();
        ctx.stroke();
        
        // 入力線
        ctx.strokeStyle = '#666';
        ctx.beginPath();
        ctx.moveTo(40, 75);
        ctx.lineTo(100, 75);
        ctx.moveTo(40, 125);
        ctx.lineTo(100, 125);
        ctx.stroke();
        
        // 出力線
        ctx.strokeStyle = '#00ff88';
        ctx.beginPath();
        ctx.moveTo(200, 100);
        ctx.lineTo(260, 100);
        ctx.stroke();
        
        // ラベル
        ctx.fillStyle = '#e0e0e0';
        ctx.font = 'bold 20px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText('AND', 150, 100);
        
        // React Flowデモ（簡略化）
        const reactFlowContainer = document.getElementById('reactflow-demo');
        reactFlowContainer.innerHTML = `
            <div style="padding: 20px; text-align: center; color: #888;">
                <p>React Flowは外部ライブラリのため、実際の動作デモは省略します。</p>
                <p>高度なインタラクティブ機能（ドラッグ&ドロップ、ズーム、パン）をサポートします。</p>
                <p>詳細は<a href="https://reactflow.dev" target="_blank" style="color: #00ff88;">公式サイト</a>をご覧ください。</p>
            </div>
        `;
    </script>
</body>
</html>