<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›è·¯å›³ã‚«ã‚¿ãƒ­ã‚° V2 - åˆ¶ä½œãƒ¢ãƒ¼ãƒ‰æç”»ã‚·ã‚¹ãƒ†ãƒ </title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #1a1b26;
      color: #e8e8ec;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    h1 {
      color: #00ff88;
      margin-bottom: 30px;
      text-align: center;
    }

    .catalog-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
      gap: 30px;
      margin-bottom: 50px;
    }

    /* å›è·¯ã‚«ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ« */
    .circuit-card {
      background-color: #24253a;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      transition: transform 0.2s ease;
    }

    .circuit-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }

    .circuit-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 15px;
      color: #00ff88;
    }

    .circuit-description {
      font-size: 14px;
      color: #9ca3af;
      margin-bottom: 20px;
    }

    .lesson-circuit-svg {
      width: 100%;
      height: auto;
      background-color: #2a2b3d;
      border-radius: 8px;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    /* ã‚²ãƒ¼ãƒˆã‚¹ã‚¿ã‚¤ãƒ« */
    .gate-body {
      fill: #363849;
      stroke: #00ff88;
      stroke-width: 2;
    }

    .gate-label {
      fill: #e8e8ec;
      font-size: 14px;
      font-weight: bold;
      text-anchor: middle;
      dominant-baseline: middle;
    }

    /* ãƒ¯ã‚¤ãƒ¤ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ« */
    .wire {
      fill: none;
      stroke: #565869;
      stroke-width: 3;
    }

    .wire.active {
      stroke: #00ff88;
    }

    /* ãƒ”ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« */
    .gate-pin {
      fill: #00ff88;
      stroke: none;
    }

    .gate-pin-line {
      stroke: #00ff88;
      stroke-width: 2;
    }

    /* çœŸç†å€¤è¡¨ */
    .truth-table {
      margin-top: 15px;
      font-size: 12px;
    }

    .truth-table table {
      width: 100%;
      border-collapse: collapse;
      background-color: #1e1f2e;
      border-radius: 4px;
      overflow: hidden;
    }

    .truth-table th,
    .truth-table td {
      padding: 8px;
      text-align: center;
      border: 1px solid #2a2b3d;
    }

    .truth-table th {
      background-color: #2a2b3d;
      color: #00ff88;
      font-weight: bold;
    }

    .truth-table td {
      color: #e8e8ec;
    }

    .stats {
      background-color: #1e1f2e;
      padding: 20px;
      border-radius: 8px;
      margin-top: 40px;
      text-align: center;
    }

    .stats h2 {
      color: #00ff88;
      margin-bottom: 15px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .stat-item {
      background-color: #24253a;
      padding: 15px;
      border-radius: 8px;
    }

    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #00ff88;
    }

    .stat-label {
      font-size: 14px;
      color: #9ca3af;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¯ å›è·¯å›³ã‚«ã‚¿ãƒ­ã‚° V2 - åˆ¶ä½œãƒ¢ãƒ¼ãƒ‰æç”»ã‚·ã‚¹ãƒ†ãƒ </h1>
    <div id="root"></div>
  </div>

  <script type="text/babel">
    // ã‚²ãƒ¼ãƒˆãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ï¼ˆç°¡æ˜“ç‰ˆï¼‰
    const GateRenderer = ({ gate }) => {
      const renderIOGate = () => {
        const label = gate.metadata?.name || gate.type;
        const isInput = gate.type === 'INPUT';
        
        return (
          <>
            <rect
              className="gate-body"
              x={-35}
              y={-25}
              width={70}
              height={50}
              rx={8}
            />
            <text className="gate-label" x={0} y={0}>
              {label}
            </text>
            {isInput ? (
              <circle className="gate-pin" cx={35} cy={0} r={5} />
            ) : (
              <>
                <line className="gate-pin-line" x1={-35} y1={0} x2={-45} y2={0} />
                <circle className="gate-pin" cx={-45} cy={0} r={5} fill="none" stroke="#00ff88" strokeWidth={2} />
              </>
            )}
          </>
        );
      };

      const renderBasicGate = () => {
        const inputCount = gate.type === 'NOT' ? 1 : 2;
        
        return (
          <>
            <rect className="gate-body" x={-35} y={-25} width={70} height={50} rx={8} />
            <text className="gate-label" x={0} y={0}>
              {gate.metadata?.name || gate.type}
            </text>
            {inputCount === 1 ? (
              <>
                <line x1={-35} y1={0} x2={-45} y2={0} stroke="#00ff88" strokeWidth={2} />
                <circle cx={-45} cy={0} r={5} fill="none" stroke="#00ff88" strokeWidth={2} />
              </>
            ) : (
              <>
                <line x1={-35} y1={-10} x2={-45} y2={-10} stroke="#00ff88" strokeWidth={2} />
                <circle cx={-45} cy={-10} r={5} fill="none" stroke="#00ff88" strokeWidth={2} />
                <line x1={-35} y1={10} x2={-45} y2={10} stroke="#00ff88" strokeWidth={2} />
                <circle cx={-45} cy={10} r={5} fill="none" stroke="#00ff88" strokeWidth={2} />
              </>
            )}
            <line x1={35} y1={0} x2={45} y2={0} stroke="#00ff88" strokeWidth={2} />
            <circle cx={45} cy={0} r={5} fill={gate.output ? '#00ff88' : 'none'} stroke="#00ff88" strokeWidth={2} />
          </>
        );
      };

      return (
        <g transform={`translate(${gate.position.x}, ${gate.position.y})`}>
          {(gate.type === 'INPUT' || gate.type === 'OUTPUT') ? renderIOGate() : renderBasicGate()}
        </g>
      );
    };

    // ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ï¼ˆç›´äº¤é…ç·šç‰ˆï¼‰
    const WireRenderer = ({ wire, gates, useOrthogonal = true }) => {
      const fromGate = gates.find(g => g.id === wire.from.gateId);
      const toGate = gates.find(g => g.id === wire.to.gateId);

      if (!fromGate || !toGate) return null;

      let fromX = fromGate.position.x;
      let fromY = fromGate.position.y;
      let toX = toGate.position.x;
      let toY = toGate.position.y;

      // ãƒ”ãƒ³ä½ç½®èª¿æ•´
      if (fromGate.type === 'INPUT') {
        fromX += 35;
      } else if (fromGate.type !== 'OUTPUT') {
        fromX += 45;
      }

      if (toGate.type === 'OUTPUT') {
        toX -= 45;
      } else if (toGate.type !== 'INPUT') {
        toX -= 45;
        toY += wire.to.pinIndex === 0 ? -10 : 10;
      }

      let path;
      if (useOrthogonal) {
        // ç›´äº¤é…ç·šï¼ˆLå­—å‹ï¼‰
        const cornerX = fromX + (toX - fromX) * 0.7;
        path = `M ${fromX} ${fromY} L ${cornerX} ${fromY} L ${cornerX} ${toY} L ${toX} ${toY}`;
      } else {
        // ãƒ™ã‚¸ã‚§æ›²ç·šï¼ˆå¾“æ¥ç‰ˆï¼‰
        const midX = (fromX + toX) / 2;
        path = `M ${fromX} ${fromY} Q ${midX} ${fromY} ${midX} ${(fromY + toY) / 2} T ${toX} ${toY}`;
      }

      return <path className={`wire ${wire.isActive ? 'active' : ''}`} d={path} />;
    };

    // å›è·¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const CircuitDiagram = ({ circuit, viewBox, useOrthogonal }) => {
      return (
        <svg viewBox={viewBox} className="lesson-circuit-svg">
          <g className="wires">
            {circuit.wires.map(wire => (
              <WireRenderer key={wire.id} wire={wire} gates={circuit.gates} useOrthogonal={useOrthogonal} />
            ))}
          </g>
          <g className="gates">
            {circuit.gates.map(gate => (
              <GateRenderer key={gate.id} gate={gate} />
            ))}
          </g>
        </svg>
      );
    };

    // å›è·¯ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const CircuitCard = ({ title, description, circuit, viewBox, truthTable, useOrthogonal }) => {
      return (
        <div className="circuit-card">
          <h3 className="circuit-title">{title}</h3>
          <p className="circuit-description">{description}</p>
          <CircuitDiagram circuit={circuit} viewBox={viewBox} useOrthogonal={useOrthogonal} />
          {truthTable && (
            <div className="truth-table">
              <table>
                <thead>
                  <tr>
                    {truthTable.headers.map(header => (
                      <th key={header}>{header}</th>
                    ))}
                  </tr>
                </thead>
                <tbody>
                  {truthTable.rows.map((row, i) => (
                    <tr key={i}>
                      {row.map((cell, j) => (
                        <td key={j}>{cell}</td>
                      ))}
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>
      );
    };

    // ã‚«ã‚¿ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿
    const circuits = [
      {
        title: 'åŠåŠ ç®—å™¨ï¼ˆHalf Adderï¼‰',
        description: '2ã¤ã®1ãƒ“ãƒƒãƒˆæ•°ã‚’åŠ ç®—ã—ã€å’Œï¼ˆSumï¼‰ã¨ç¹°ã‚Šä¸ŠãŒã‚Šï¼ˆCarryï¼‰ã‚’å‡ºåŠ›ã™ã‚‹åŸºæœ¬çš„ãªç®—è¡“å›è·¯',
        viewBox: '0 0 700 400',
        circuit: {
          gates: [
            { id: 'input-a', type: 'INPUT', position: { x: 100, y: 150 }, output: true, metadata: { name: 'A' } },
            { id: 'input-b', type: 'INPUT', position: { x: 100, y: 250 }, output: false, metadata: { name: 'B' } },
            { id: 'xor-gate', type: 'XOR', position: { x: 350, y: 120 }, output: true },
            { id: 'and-gate', type: 'AND', position: { x: 350, y: 280 }, output: false },
            { id: 'output-sum', type: 'OUTPUT', position: { x: 550, y: 120 }, metadata: { name: 'Sum' } },
            { id: 'output-carry', type: 'OUTPUT', position: { x: 550, y: 280 }, metadata: { name: 'Carry' } },
          ],
          wires: [
            { id: 'w1', from: { gateId: 'input-a', pinIndex: -1 }, to: { gateId: 'xor-gate', pinIndex: 0 }, isActive: true },
            { id: 'w2', from: { gateId: 'input-b', pinIndex: -1 }, to: { gateId: 'xor-gate', pinIndex: 1 }, isActive: false },
            { id: 'w3', from: { gateId: 'input-a', pinIndex: -1 }, to: { gateId: 'and-gate', pinIndex: 0 }, isActive: true },
            { id: 'w4', from: { gateId: 'input-b', pinIndex: -1 }, to: { gateId: 'and-gate', pinIndex: 1 }, isActive: false },
            { id: 'w5', from: { gateId: 'xor-gate', pinIndex: -1 }, to: { gateId: 'output-sum', pinIndex: 0 }, isActive: true },
            { id: 'w6', from: { gateId: 'and-gate', pinIndex: -1 }, to: { gateId: 'output-carry', pinIndex: 0 }, isActive: false },
          ]
        },
        truthTable: {
          headers: ['A', 'B', 'Sum', 'Carry'],
          rows: [
            ['0', '0', '0', '0'],
            ['0', '1', '1', '0'],
            ['1', '0', '1', '0'],
            ['1', '1', '0', '1'],
          ]
        }
      },
      {
        title: 'å…¨åŠ ç®—å™¨ï¼ˆFull Adderï¼‰',
        description: 'å‰ã®æ¡ã‹ã‚‰ã®ç¹°ã‚Šä¸ŠãŒã‚Šã‚‚è€ƒæ…®ã—ãŸ3å…¥åŠ›ã®åŠ ç®—å™¨ã€‚è¤‡æ•°æ¡ã®åŠ ç®—ã«å¿…é ˆ',
        viewBox: '0 0 750 450',
        circuit: {
          gates: [
            { id: 'input-a', type: 'INPUT', position: { x: 50, y: 100 }, output: true, metadata: { name: 'A' } },
            { id: 'input-b', type: 'INPUT', position: { x: 50, y: 200 }, output: true, metadata: { name: 'B' } },
            { id: 'input-cin', type: 'INPUT', position: { x: 50, y: 300 }, output: false, metadata: { name: 'Cin' } },
            { id: 'xor1', type: 'XOR', position: { x: 250, y: 100 }, output: false },
            { id: 'and1', type: 'AND', position: { x: 250, y: 200 }, output: false },
            { id: 'xor2', type: 'XOR', position: { x: 450, y: 150 }, output: true },
            { id: 'and2', type: 'AND', position: { x: 450, y: 250 }, output: false },
            { id: 'or-gate', type: 'OR', position: { x: 450, y: 350 }, output: false },
            { id: 'output-sum', type: 'OUTPUT', position: { x: 650, y: 150 }, metadata: { name: 'Sum' } },
            { id: 'output-cout', type: 'OUTPUT', position: { x: 650, y: 350 }, metadata: { name: 'Cout' } },
          ],
          wires: [
            { from: { gateId: 'input-a', pinIndex: -1 }, to: { gateId: 'xor1', pinIndex: 0 }, isActive: true },
            { from: { gateId: 'input-b', pinIndex: -1 }, to: { gateId: 'xor1', pinIndex: 1 }, isActive: true },
            { from: { gateId: 'input-a', pinIndex: -1 }, to: { gateId: 'and1', pinIndex: 0 }, isActive: true },
            { from: { gateId: 'input-b', pinIndex: -1 }, to: { gateId: 'and1', pinIndex: 1 }, isActive: true },
            { from: { gateId: 'xor1', pinIndex: -1 }, to: { gateId: 'xor2', pinIndex: 0 }, isActive: false },
            { from: { gateId: 'input-cin', pinIndex: -1 }, to: { gateId: 'xor2', pinIndex: 1 }, isActive: false },
            { from: { gateId: 'xor1', pinIndex: -1 }, to: { gateId: 'and2', pinIndex: 0 }, isActive: false },
            { from: { gateId: 'input-cin', pinIndex: -1 }, to: { gateId: 'and2', pinIndex: 1 }, isActive: false },
            { from: { gateId: 'and1', pinIndex: -1 }, to: { gateId: 'or-gate', pinIndex: 0 }, isActive: false },
            { from: { gateId: 'and2', pinIndex: -1 }, to: { gateId: 'or-gate', pinIndex: 1 }, isActive: false },
            { from: { gateId: 'xor2', pinIndex: -1 }, to: { gateId: 'output-sum', pinIndex: 0 }, isActive: true },
            { from: { gateId: 'or-gate', pinIndex: -1 }, to: { gateId: 'output-cout', pinIndex: 0 }, isActive: false },
          ]
        },
        truthTable: {
          headers: ['A', 'B', 'Cin', 'Sum', 'Cout'],
          rows: [
            ['0', '0', '0', '0', '0'],
            ['0', '0', '1', '1', '0'],
            ['0', '1', '0', '1', '0'],
            ['0', '1', '1', '0', '1'],
            ['1', '0', '0', '1', '0'],
            ['1', '0', '1', '0', '1'],
            ['1', '1', '0', '0', '1'],
            ['1', '1', '1', '1', '1'],
          ]
        }
      },
      {
        title: '2ãƒ“ãƒƒãƒˆæ¯”è¼ƒå™¨ï¼ˆComparatorï¼‰',
        description: '2ã¤ã®2ãƒ“ãƒƒãƒˆæ•°ã‚’æ¯”è¼ƒã—ã€ç­‰ã—ã„ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹å›è·¯ï¼ˆA=Bæ¤œå‡ºï¼‰',
        viewBox: '0 0 750 500',
        circuit: {
          gates: [
            { id: 'input-a0', type: 'INPUT', position: { x: 50, y: 100 }, output: false, metadata: { name: 'A0' } },
            { id: 'input-a1', type: 'INPUT', position: { x: 50, y: 200 }, output: true, metadata: { name: 'A1' } },
            { id: 'input-b0', type: 'INPUT', position: { x: 50, y: 300 }, output: false, metadata: { name: 'B0' } },
            { id: 'input-b1', type: 'INPUT', position: { x: 50, y: 400 }, output: true, metadata: { name: 'B1' } },
            { id: 'xor0', type: 'XOR', position: { x: 250, y: 200 }, output: false },
            { id: 'not0', type: 'NOT', position: { x: 350, y: 200 }, output: true },
            { id: 'xor1', type: 'XOR', position: { x: 250, y: 350 }, output: false },
            { id: 'not1', type: 'NOT', position: { x: 350, y: 350 }, output: true },
            { id: 'and-equal', type: 'AND', position: { x: 500, y: 275 }, output: true },
            { id: 'output-equal', type: 'OUTPUT', position: { x: 650, y: 275 }, metadata: { name: 'A=B' } },
          ],
          wires: [
            { from: { gateId: 'input-a0', pinIndex: -1 }, to: { gateId: 'xor0', pinIndex: 0 }, isActive: false },
            { from: { gateId: 'input-b0', pinIndex: -1 }, to: { gateId: 'xor0', pinIndex: 1 }, isActive: false },
            { from: { gateId: 'xor0', pinIndex: -1 }, to: { gateId: 'not0', pinIndex: 0 }, isActive: false },
            { from: { gateId: 'input-a1', pinIndex: -1 }, to: { gateId: 'xor1', pinIndex: 0 }, isActive: true },
            { from: { gateId: 'input-b1', pinIndex: -1 }, to: { gateId: 'xor1', pinIndex: 1 }, isActive: true },
            { from: { gateId: 'xor1', pinIndex: -1 }, to: { gateId: 'not1', pinIndex: 0 }, isActive: false },
            { from: { gateId: 'not0', pinIndex: -1 }, to: { gateId: 'and-equal', pinIndex: 0 }, isActive: true },
            { from: { gateId: 'not1', pinIndex: -1 }, to: { gateId: 'and-equal', pinIndex: 1 }, isActive: true },
            { from: { gateId: 'and-equal', pinIndex: -1 }, to: { gateId: 'output-equal', pinIndex: 0 }, isActive: true },
          ]
        }
      }
    ];

    // ãƒ¡ã‚¤ãƒ³ã‚«ã‚¿ãƒ­ã‚°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const CircuitCatalog = () => {
      const [useOrthogonal, setUseOrthogonal] = React.useState(true);
      
      return (
        <>
          <div style={{ 
            textAlign: 'center', 
            marginBottom: '30px',
            padding: '20px',
            backgroundColor: '#24253a',
            borderRadius: '8px'
          }}>
            <h2 style={{ color: '#00ff88', marginBottom: '15px' }}>ğŸ”€ é…ç·šã‚¹ã‚¿ã‚¤ãƒ«åˆ‡ã‚Šæ›¿ãˆ</h2>
            <button
              onClick={() => setUseOrthogonal(!useOrthogonal)}
              style={{
                padding: '10px 30px',
                fontSize: '16px',
                backgroundColor: useOrthogonal ? '#00ff88' : '#ff6699',
                color: '#1a1b26',
                border: 'none',
                borderRadius: '6px',
                cursor: 'pointer',
                fontWeight: 'bold',
                transition: 'all 0.3s ease'
              }}
            >
              {useOrthogonal ? 'ğŸ“ ç›´äº¤é…ç·š' : 'ã€°ï¸ ãƒ™ã‚¸ã‚§æ›²ç·š'}
            </button>
            <p style={{ marginTop: '10px', color: '#9ca3af', fontSize: '14px' }}>
              ç¾åœ¨: {useOrthogonal ? 'æ¥­ç•Œæ¨™æº–ã®ç›´äº¤é…ç·šï¼ˆå­¦ç¿’ãƒ¢ãƒ¼ãƒ‰æ¨å¥¨ï¼‰' : 'æ»‘ã‚‰ã‹ãªãƒ™ã‚¸ã‚§æ›²ç·šï¼ˆåˆ¶ä½œãƒ¢ãƒ¼ãƒ‰ï¼‰'}
            </p>
          </div>
          
          <div className="catalog-grid">
            {circuits.map((circuit, index) => (
              <CircuitCard key={index} {...circuit} useOrthogonal={useOrthogonal} />
            ))}
          </div>
          
          <div className="stats">
            <h2>ğŸ“Š ã‚«ã‚¿ãƒ­ã‚°çµ±è¨ˆ</h2>
            <div className="stats-grid">
              <div className="stat-item">
                <div className="stat-value">{circuits.length}</div>
                <div className="stat-label">å›è·¯æ•°</div>
              </div>
              <div className="stat-item">
                <div className="stat-value">
                  {circuits.reduce((sum, c) => sum + c.circuit.gates.length, 0)}
                </div>
                <div className="stat-label">ç·ã‚²ãƒ¼ãƒˆæ•°</div>
              </div>
              <div className="stat-item">
                <div className="stat-value">
                  {circuits.reduce((sum, c) => sum + c.circuit.wires.length, 0)}
                </div>
                <div className="stat-label">ç·ãƒ¯ã‚¤ãƒ¤ãƒ¼æ•°</div>
              </div>
              <div className="stat-item">
                <div className="stat-value">100%</div>
                <div className="stat-label">çµ±ä¸€æ€§</div>
              </div>
            </div>
          </div>
        </>
      );
    };

    // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<CircuitCatalog />);
  </script>
</body>
</html>