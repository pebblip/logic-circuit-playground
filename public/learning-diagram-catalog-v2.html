<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学習モード ダイアグラムカタログ v2 - 正しい実装</title>
    <style>
        /* カラーシステム（プロジェクトに合わせる） */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --accent-green: #00ff88;
            --accent-red: #ff6b6b;
            --accent-blue: #4ecdc4;
            --accent-yellow: #ffd93d;
            --accent-orange: #ff9500;
            --wire-inactive: #666666;
            --border-color: #333333;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        h1 {
            text-align: center;
            color: var(--accent-green);
            margin-bottom: 3rem;
            font-size: 2.5rem;
        }
        
        .info-box {
            background: var(--bg-secondary);
            border-left: 4px solid var(--accent-green);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 8px;
        }
        
        .category {
            margin-bottom: 4rem;
        }
        
        .category-title {
            color: var(--accent-green);
            font-size: 2rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .diagram-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
        }
        
        .diagram-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0,0,0,0.4);
        }
        
        .diagram-header {
            background: var(--bg-tertiary);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .diagram-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .diagram-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* StaticCircuitDiagramのスタイルを模倣 */
        .static-circuit-diagram {
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .static-circuit-diagram h4 {
            text-align: center;
            margin-bottom: 10px;
            color: var(--accent-green);
        }
        
        .static-circuit-diagram svg {
            max-width: 100%;
            background-color: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
        }
        
        /* ゲートスタイル */
        .gate {
            fill: var(--bg-tertiary);
            stroke: #444;
            stroke-width: 2;
        }
        
        .gate-text {
            fill: #e0e0e0;
            font-size: 16px;
            font-weight: bold;
        }
        
        /* ピンスタイル */
        .pin {
            fill: var(--wire-inactive);
        }
        
        .pin.active {
            fill: var(--accent-green);
        }
        
        .pin-line {
            stroke: var(--wire-inactive);
            stroke-width: 2;
        }
        
        .pin-line.active {
            stroke: var(--accent-green);
        }
        
        /* ワイヤースタイル */
        .wire {
            stroke: var(--wire-inactive);
            stroke-width: 2;
            fill: none;
        }
        
        .wire.active {
            stroke: var(--accent-green);
        }
        
        /* Canvas部分（波形用） */
        .canvas-wrapper {
            background: var(--bg-primary);
            padding: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 250px;
        }
        
        canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }
        
        /* テーブルスタイル */
        .table-wrapper {
            padding: 1rem 1.5rem;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-family: monospace;
        }
        
        th, td {
            padding: 0.75rem;
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        th {
            background: var(--bg-tertiary);
            color: var(--accent-green);
            font-weight: bold;
        }
        
        td {
            background: var(--bg-primary);
        }
        
        .truth-1 {
            background: var(--accent-green) !important;
            color: var(--bg-primary);
            font-weight: bold;
        }
        
        /* コードサンプル */
        .code-sample {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }
        
        pre {
            margin: 0;
            color: #e0e0e0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
        }
        
        .keyword {
            color: var(--accent-blue);
        }
        
        .string {
            color: var(--accent-green);
        }
        
        .number {
            color: var(--accent-orange);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>学習モード ダイアグラムカタログ v2</h1>
        
        <div class="info-box">
            <h3>実装方針</h3>
            <ul>
                <li><strong>回路図（ゲート・配線）</strong>: StaticCircuitDiagramコンポーネントを使用（既存のゲートレンダラーのデザインを活用）</li>
                <li><strong>波形・タイミングチャート</strong>: Canvas APIで新規実装</li>
                <li><strong>真理値表</strong>: HTMLテーブル（現状維持）</li>
            </ul>
        </div>
        
        <!-- カテゴリ1: 回路図（StaticCircuitDiagram） -->
        <section class="category">
            <h2 class="category-title">1. 回路図（StaticCircuitDiagram使用）</h2>
            <div class="diagram-grid">
                
                <!-- ANDゲート基本回路 -->
                <div class="diagram-card">
                    <div class="diagram-header">
                        <h3 class="diagram-title">ANDゲート基本回路</h3>
                        <p class="diagram-description">2入力ANDゲートの基本構成</p>
                    </div>
                    <div class="static-circuit-diagram">
                        <svg viewBox="0 0 600 300" width="100%" height="100%" style="max-width: 600px;">
                            <!-- グリッド -->
                            <defs>
                                <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                                    <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#333" stroke-width="0.5"/>
                                </pattern>
                            </defs>
                            <rect width="100%" height="100%" fill="url(#grid)" opacity="0.3" />
                            
                            <!-- ワイヤー -->
                            <path d="M 135 100 Q 200 100 200 135 T 265 135" fill="none" stroke="#00ff88" stroke-width="2" class="wire active"/>
                            <path d="M 135 200 Q 200 200 200 165 T 265 165" fill="none" stroke="#00ff88" stroke-width="2" class="wire active"/>
                            <path d="M 335 150 L 465 150" fill="none" stroke="#00ff88" stroke-width="2" class="wire active"/>
                            
                            <!-- INPUT A -->
                            <g transform="translate(100, 100)">
                                <rect x="-25" y="-15" width="50" height="30" rx="15" fill="#00ff88" stroke="#444" stroke-width="2"/>
                                <circle cx="10" cy="0" r="12" fill="#e0e0e0"/>
                                <text x="0" y="-25" text-anchor="middle" fill="#888" font-size="12">A</text>
                                <line x1="25" y1="0" x2="35" y2="0" stroke="#00ff88" stroke-width="2"/>
                                <circle cx="35" cy="0" r="6" fill="#00ff88"/>
                            </g>
                            
                            <!-- INPUT B -->
                            <g transform="translate(100, 200)">
                                <rect x="-25" y="-15" width="50" height="30" rx="15" fill="#00ff88" stroke="#444" stroke-width="2"/>
                                <circle cx="10" cy="0" r="12" fill="#e0e0e0"/>
                                <text x="0" y="-25" text-anchor="middle" fill="#888" font-size="12">B</text>
                                <line x1="25" y1="0" x2="35" y2="0" stroke="#00ff88" stroke-width="2"/>
                                <circle cx="35" cy="0" r="6" fill="#00ff88"/>
                            </g>
                            
                            <!-- ANDゲート -->
                            <g transform="translate(300, 150)">
                                <rect x="-35" y="-25" width="70" height="50" rx="8" fill="#2a2a2a" stroke="#444" stroke-width="2" class="gate"/>
                                <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" fill="#e0e0e0" font-size="16" font-weight="bold" class="gate-text">AND</text>
                                <!-- 入力ピン -->
                                <line x1="-45" y1="-15" x2="-35" y2="-15" stroke="#00ff88" stroke-width="2" class="pin-line active"/>
                                <circle cx="-45" cy="-15" r="6" fill="#00ff88" class="pin active"/>
                                <line x1="-45" y1="15" x2="-35" y2="15" stroke="#00ff88" stroke-width="2" class="pin-line active"/>
                                <circle cx="-45" cy="15" r="6" fill="#00ff88" class="pin active"/>
                                <!-- 出力ピン -->
                                <line x1="35" y1="0" x2="45" y2="0" stroke="#00ff88" stroke-width="2" class="pin-line active"/>
                                <circle cx="45" cy="0" r="6" fill="#00ff88" class="pin active"/>
                            </g>
                            
                            <!-- OUTPUT Y -->
                            <g transform="translate(500, 150)">
                                <circle cx="0" cy="0" r="20" fill="none" stroke="#444" stroke-width="2"/>
                                <circle cx="0" cy="0" r="15" fill="#00ff88"/>
                                <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" font-size="20">💡</text>
                                <text x="0" y="35" text-anchor="middle" fill="#888" font-size="12">Y</text>
                                <line x1="-35" y1="0" x2="-20" y2="0" stroke="#00ff88" stroke-width="2"/>
                                <circle cx="-35" cy="0" r="6" fill="#00ff88"/>
                            </g>
                        </svg>
                    </div>
                    
                    <div class="code-sample">
                        <pre><code><span class="keyword">const</span> andGateCircuit = {
  <span class="string">gates</span>: [
    { <span class="string">type</span>: <span class="string">'INPUT'</span>, <span class="string">x</span>: <span class="number">100</span>, <span class="string">y</span>: <span class="number">100</span>, <span class="string">label</span>: <span class="string">'A'</span> },
    { <span class="string">type</span>: <span class="string">'INPUT'</span>, <span class="string">x</span>: <span class="number">100</span>, <span class="string">y</span>: <span class="number">200</span>, <span class="string">label</span>: <span class="string">'B'</span> },
    { <span class="string">type</span>: <span class="string">'AND'</span>, <span class="string">x</span>: <span class="number">300</span>, <span class="string">y</span>: <span class="number">150</span> },
    { <span class="string">type</span>: <span class="string">'OUTPUT'</span>, <span class="string">x</span>: <span class="number">500</span>, <span class="string">y</span>: <span class="number">150</span>, <span class="string">label</span>: <span class="string">'Y'</span> }
  ]
};</code></pre>
                    </div>
                    
                    <div class="table-wrapper">
                        <table>
                            <tr><th>A</th><th>B</th><th>Y</th></tr>
                            <tr><td>0</td><td>0</td><td>0</td></tr>
                            <tr><td>0</td><td>1</td><td>0</td></tr>
                            <tr><td>1</td><td>0</td><td>0</td></tr>
                            <tr><td>1</td><td>1</td><td class="truth-1">1</td></tr>
                        </table>
                    </div>
                </div>
                
                <!-- 半加算器 -->
                <div class="diagram-card">
                    <div class="diagram-header">
                        <h3 class="diagram-title">半加算器</h3>
                        <p class="diagram-description">XORとANDで構成される1ビット加算器</p>
                    </div>
                    <div class="static-circuit-diagram">
                        <h4>Half Adder</h4>
                        <svg viewBox="0 0 600 350" width="100%" height="100%" style="max-width: 600px;">
                            <!-- 簡略化のため、基本的な構成のみ表示 -->
                            <!-- INPUT A -->
                            <g transform="translate(100, 100)">
                                <rect x="-25" y="-15" width="50" height="30" rx="15" fill="#00ff88" stroke="#444" stroke-width="2"/>
                                <circle cx="10" cy="0" r="12" fill="#e0e0e0"/>
                                <text x="0" y="-25" text-anchor="middle" fill="#888" font-size="12">A</text>
                            </g>
                            
                            <!-- INPUT B -->
                            <g transform="translate(100, 250)">
                                <rect x="-25" y="-15" width="50" height="30" rx="15" fill="#333" stroke="#444" stroke-width="2"/>
                                <circle cx="-10" cy="0" r="12" fill="#e0e0e0"/>
                                <text x="0" y="-25" text-anchor="middle" fill="#888" font-size="12">B</text>
                            </g>
                            
                            <!-- XORゲート（Sum用） -->
                            <g transform="translate(300, 100)">
                                <rect x="-35" y="-25" width="70" height="50" rx="8" fill="#2a2a2a" stroke="#444" stroke-width="2"/>
                                <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" fill="#e0e0e0" font-size="16" font-weight="bold">XOR</text>
                            </g>
                            
                            <!-- ANDゲート（Carry用） -->
                            <g transform="translate(300, 250)">
                                <rect x="-35" y="-25" width="70" height="50" rx="8" fill="#2a2a2a" stroke="#444" stroke-width="2"/>
                                <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" fill="#e0e0e0" font-size="16" font-weight="bold">AND</text>
                            </g>
                            
                            <!-- OUTPUT Sum -->
                            <g transform="translate(500, 100)">
                                <circle cx="0" cy="0" r="20" fill="none" stroke="#444" stroke-width="2"/>
                                <circle cx="0" cy="0" r="15" fill="#00ff88"/>
                                <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" font-size="20">💡</text>
                                <text x="0" y="35" text-anchor="middle" fill="#888" font-size="12">Sum</text>
                            </g>
                            
                            <!-- OUTPUT Carry -->
                            <g transform="translate(500, 250)">
                                <circle cx="0" cy="0" r="20" fill="none" stroke="#444" stroke-width="2"/>
                                <circle cx="0" cy="0" r="15" fill="#333"/>
                                <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" font-size="20">💡</text>
                                <text x="0" y="35" text-anchor="middle" fill="#888" font-size="12">Carry</text>
                            </g>
                            
                            <!-- 配線は省略（実際はStaticCircuitDiagramが描画） -->
                        </svg>
                    </div>
                    
                    <div class="table-wrapper">
                        <table>
                            <tr><th>A</th><th>B</th><th>Sum</th><th>Carry</th></tr>
                            <tr><td>0</td><td>0</td><td>0</td><td>0</td></tr>
                            <tr><td>0</td><td>1</td><td class="truth-1">1</td><td>0</td></tr>
                            <tr><td>1</td><td>0</td><td class="truth-1">1</td><td>0</td></tr>
                            <tr><td>1</td><td>1</td><td>0</td><td class="truth-1">1</td></tr>
                        </table>
                    </div>
                </div>
                
            </div>
        </section>
        
        <!-- カテゴリ2: 波形・タイミング（Canvas API） -->
        <section class="category">
            <h2 class="category-title">2. 波形・タイミング（Canvas API実装）</h2>
            <div class="diagram-grid">
                
                <!-- アナログ vs デジタル -->
                <div class="diagram-card">
                    <div class="diagram-header">
                        <h3 class="diagram-title">アナログ vs デジタル信号</h3>
                        <p class="diagram-description">連続的な変化と離散的な2値の比較</p>
                    </div>
                    <div class="canvas-wrapper">
                        <canvas id="analogVsDigital" width="400" height="250"></canvas>
                    </div>
                </div>
                
                <!-- クロック信号 -->
                <div class="diagram-card">
                    <div class="diagram-header">
                        <h3 class="diagram-title">クロック信号</h3>
                        <p class="diagram-description">一定周期で変化する同期信号</p>
                    </div>
                    <div class="canvas-wrapper">
                        <canvas id="clockSignal" width="400" height="200"></canvas>
                    </div>
                </div>
                
                <!-- タイミングチャート -->
                <div class="diagram-card">
                    <div class="diagram-header">
                        <h3 class="diagram-title">D-FFタイミングチャート</h3>
                        <p class="diagram-description">CLK、D、Q信号の時間関係</p>
                    </div>
                    <div class="canvas-wrapper">
                        <canvas id="timingChart" width="400" height="250"></canvas>
                    </div>
                </div>
                
            </div>
        </section>
        
        <!-- カテゴリ3: 実装サンプル -->
        <section class="category">
            <h2 class="category-title">3. 実装サンプル</h2>
            
            <div class="info-box">
                <h3>StaticCircuitDiagramの使用例</h3>
                <div class="code-sample">
                    <pre><code><span class="keyword">import</span> { StaticCircuitDiagram, predefinedCircuits } <span class="keyword">from</span> <span class="string">'@/components/circuit-diagram/StaticCircuitDiagram'</span>;

<span class="keyword">const</span> LessonComponent = () => {
  <span class="keyword">return</span> (
    &lt;<span class="keyword">div</span>&gt;
      {<span class="comment">/* 事前定義された回路を使用 */</span>}
      &lt;<span class="keyword">StaticCircuitDiagram</span> {...predefinedCircuits.halfAdder} /&gt;
      
      {<span class="comment">/* カスタム回路を定義 */</span>}
      &lt;<span class="keyword">StaticCircuitDiagram</span>
        <span class="string">gates</span>={[
          { <span class="string">type</span>: <span class="string">'INPUT'</span>, <span class="string">x</span>: <span class="number">100</span>, <span class="string">y</span>: <span class="number">150</span>, <span class="string">label</span>: <span class="string">'A'</span> },
          { <span class="string">type</span>: <span class="string">'NOT'</span>, <span class="string">x</span>: <span class="number">300</span>, <span class="string">y</span>: <span class="number">150</span> },
          { <span class="string">type</span>: <span class="string">'OUTPUT'</span>, <span class="string">x</span>: <span class="number">500</span>, <span class="string">y</span>: <span class="number">150</span>, <span class="string">label</span>: <span class="string">'Y'</span> }
        ]}
        <span class="string">wires</span>={[
          { <span class="string">from</span>: { <span class="string">x</span>: <span class="number">135</span>, <span class="string">y</span>: <span class="number">150</span> }, <span class="string">to</span>: { <span class="string">x</span>: <span class="number">265</span>, <span class="string">y</span>: <span class="number">150</span> } },
          { <span class="string">from</span>: { <span class="string">x</span>: <span class="number">335</span>, <span class="string">y</span>: <span class="number">150</span> }, <span class="string">to</span>: { <span class="string">x</span>: <span class="number">465</span>, <span class="string">y</span>: <span class="number">150</span> } }
        ]}
        <span class="string">width</span>={<span class="number">600</span>}
        <span class="string">height</span>={<span class="number">300</span>}
        <span class="string">title</span>=<span class="string">"NOTゲート回路"</span>
      /&gt;
    &lt;/<span class="keyword">div</span>&gt;
  );
};</code></pre>
                </div>
            </div>
            
            <div class="info-box">
                <h3>Canvas波形レンダラーの使用例</h3>
                <div class="code-sample">
                    <pre><code><span class="keyword">import</span> { WaveformRenderer } <span class="keyword">from</span> <span class="string">'@/components/content-renderers/WaveformRenderer'</span>;

<span class="keyword">const</span> waveformData = {
  <span class="string">signals</span>: [
    { <span class="string">name</span>: <span class="string">'アナログ'</span>, <span class="string">type</span>: <span class="string">'analog'</span>, <span class="string">color</span>: <span class="string">'#ff9500'</span> },
    { <span class="string">name</span>: <span class="string">'デジタル'</span>, <span class="string">type</span>: <span class="string">'digital'</span>, <span class="string">color</span>: <span class="string">'#00ff88'</span> }
  ],
  <span class="string">timeScale</span>: <span class="number">100</span>
};

&lt;<span class="keyword">WaveformRenderer</span> <span class="string">data</span>={waveformData} /&gt;</code></pre>
                </div>
            </div>
        </section>
        
    </div>
    
    <script>
        // Canvas設定ヘルパー
        function setupCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            const dpr = window.devicePixelRatio || 1;
            
            // 高DPI対応
            const rect = canvas.getBoundingClientRect();
            canvas.width = canvas.width * dpr;
            canvas.height = canvas.height * dpr;
            ctx.scale(dpr, dpr);
            
            return ctx;
        }
        
        // 共通の色設定
        const colors = {
            bg: '#0a0a0a',
            gate: '#1a1a1a',
            wire: '#666666',
            wireActive: '#00ff88',
            text: '#ffffff',
            analog: '#ff9500',
            digital: '#00ff88',
            clock: '#4ecdc4'
        };
        
        // アナログ vs デジタル信号（Canvas API）
        function drawAnalogVsDigital() {
            const ctx = setupCanvas('analogVsDigital');
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, 400, 250);
            
            // グリッド
            ctx.strokeStyle = '#1a1a1a';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 8; i++) {
                const x = 50 + i * 40;
                ctx.beginPath();
                ctx.moveTo(x, 30);
                ctx.lineTo(x, 220);
                ctx.stroke();
            }
            
            // アナログ信号
            ctx.strokeStyle = colors.analog;
            ctx.lineWidth = 3;
            ctx.beginPath();
            for (let x = 50; x <= 370; x += 2) {
                const t = (x - 50) / 320;
                const y = 80 + Math.sin(t * Math.PI * 4) * 30 * (1 + 0.3 * Math.cos(t * Math.PI * 2));
                if (x === 50) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // デジタル信号
            ctx.strokeStyle = colors.digital;
            ctx.lineWidth = 3;
            ctx.beginPath();
            const bits = [1, 0, 0, 1, 1, 0, 1, 0];
            bits.forEach((bit, i) => {
                const x1 = 50 + i * 40;
                const x2 = x1 + 40;
                const y = bit ? 140 : 190;
                
                if (i === 0) {
                    ctx.moveTo(x1, y);
                } else {
                    const prevY = bits[i-1] ? 140 : 190;
                    if (y !== prevY) {
                        ctx.lineTo(x1, prevY);
                        ctx.lineTo(x1, y);
                    }
                }
                ctx.lineTo(x2, y);
                
                // ビット値（Canvas内の最小限のテキスト）
                ctx.save();
                ctx.font = '12px monospace';
                ctx.fillStyle = colors.digital;
                ctx.textAlign = 'center';
                ctx.fillText(bit.toString(), x1 + 20, 130);
                ctx.restore();
            });
            ctx.stroke();
        }
        
        // クロック信号
        function drawClockSignal() {
            const ctx = setupCanvas('clockSignal');
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, 400, 200);
            
            // グリッド
            ctx.strokeStyle = '#1a1a1a';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const x = 40 + i * 32;
                ctx.beginPath();
                ctx.moveTo(x, 30);
                ctx.lineTo(x, 170);
                ctx.stroke();
            }
            
            // クロック波形
            ctx.strokeStyle = colors.clock;
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i < 10; i++) {
                const x = 40 + i * 32;
                const phase = i % 2;
                const y = phase === 0 ? 50 : 150;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    const prevY = (i - 1) % 2 === 0 ? 50 : 150;
                    if (y !== prevY) {
                        ctx.lineTo(x, prevY);
                        ctx.lineTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
            }
            ctx.stroke();
            
            // ラベル（最小限）
            ctx.fillStyle = colors.clock;
            ctx.font = '16px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('CLK', 200, 20);
        }
        
        // タイミングチャート
        function drawTimingChart() {
            const ctx = setupCanvas('timingChart');
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, 400, 250);
            
            const signals = [
                { name: 'CLK', data: [0,1,0,1,0,1,0,1,0,1], color: colors.clock, y: 50 },
                { name: 'D', data: [0,0,1,1,1,0,0,0,1,1], color: colors.analog, y: 120 },
                { name: 'Q', data: [0,0,0,1,1,1,0,0,0,1], color: colors.digital, y: 190 }
            ];
            
            // 各信号を描画
            signals.forEach(signal => {
                ctx.strokeStyle = signal.color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                signal.data.forEach((bit, i) => {
                    const x1 = 50 + i * 35;
                    const x2 = x1 + 35;
                    const y = signal.y + (bit ? -20 : 20);
                    
                    if (i === 0) {
                        ctx.moveTo(x1, y);
                    } else {
                        const prevY = signal.y + (signal.data[i-1] ? -20 : 20);
                        if (y !== prevY) {
                            ctx.lineTo(x1, prevY);
                            ctx.lineTo(x1, y);
                        }
                    }
                    ctx.lineTo(x2, y);
                });
                ctx.stroke();
                
                // 信号名（最小限のテキスト）
                ctx.fillStyle = signal.color;
                ctx.font = '14px monospace';
                ctx.textAlign = 'right';
                ctx.fillText(signal.name, 40, signal.y);
            });
            
            // 立ち上がりエッジマーカー
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 1;
            ctx.setLineDash([2, 2]);
            for (let i = 1; i < 10; i += 2) {
                const x = 50 + i * 35;
                ctx.beginPath();
                ctx.moveTo(x, 30);
                ctx.lineTo(x, 210);
                ctx.stroke();
            }
            ctx.setLineDash([]);
        }
        
        // 初期描画
        drawAnalogVsDigital();
        drawClockSignal();
        drawTimingChart();
    </script>
</body>
</html>