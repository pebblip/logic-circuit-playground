/**
 * ğŸ¯ ã‚·ãƒ³ãƒ—ãƒ«ã‚«ã‚ªã‚¹ç™ºç”Ÿå™¨
 * 
 * D-FFäºŒæ®µéšè©•ä¾¡ã«ä¾å­˜ã—ãªã„ã€ç¢ºå®Ÿã«å‹•ä½œã™ã‚‹ã‚«ã‚ªã‚¹ç™ºç”Ÿå™¨ã®å®Ÿè£…
 * ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼šãƒã‚¤ãƒŠãƒªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ + XOR ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®çµ„ã¿åˆã‚ã›
 */

import type { CircuitMetadata } from './gallery';

export const SIMPLE_CHAOS_GENERATOR: CircuitMetadata = {
  id: 'simple-chaos-generator',
  title: 'ğŸ¯ ç¢ºå®Ÿå‹•ä½œã‚«ã‚ªã‚¹ç™ºç”Ÿå™¨',
  description: 'D-FFäºŒæ®µéšè©•ä¾¡ã«ä¾å­˜ã—ãªã„ã‚·ãƒ³ãƒ—ãƒ«ãªæ“¬ä¼¼ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆå™¨ã€‚ãƒã‚¤ãƒŠãƒªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼+ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã§ç¢ºå®Ÿã«å‹•ä½œã—ã¾ã™ã€‚',
  
  gates: [
    // ===== ã‚¯ãƒ­ãƒƒã‚¯ä¿¡å· =====
    {
      id: 'clock',
      type: 'CLOCK' as const,
      position: { x: 50, y: 150 },
      width: 60,
      height: 40,
      label: 'CLK',
      output: false,
      metadata: {
        frequency: 2, // 2Hz = ã‚†ã£ãã‚Šã¨ã—ãŸå‹•ä½œã§è¦³å¯Ÿã—ã‚„ã™ã„
        isRunning: true,
      }
    },

    // ===== 2ãƒ“ãƒƒãƒˆãƒã‚¤ãƒŠãƒªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ =====
    {
      id: 'counter',
      type: 'BINARY_COUNTER' as const,
      position: { x: 200, y: 150 },
      width: 100,
      height: 60,
      label: 'ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼',
      output: false,
      inputs: [''],
      metadata: {
        bitWidth: 2, // 2ãƒ“ãƒƒãƒˆ = 0,1,2,3 ã®å¾ªç’°
        count: 0,
        previousClockState: false
      }
    },

    // ===== ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”¨XOR =====
    {
      id: 'feedback_xor',
      type: 'XOR' as const,
      position: { x: 350, y: 100 },
      width: 60,
      height: 60,
      label: 'XOR',
      output: false,
      inputs: ['', '']
    },

    // ===== ã‚«ã‚ªã‚¹å‡ºåŠ›ãƒ“ãƒƒãƒˆ =====
    {
      id: 'chaos_bit0',
      type: 'OUTPUT' as const,
      position: { x: 500, y: 50 },
      width: 60,
      height: 40,
      label: 'ã‚«ã‚ªã‚¹0',
      output: false,
      inputs: ['']
    },
    {
      id: 'chaos_bit1', 
      type: 'OUTPUT' as const,
      position: { x: 500, y: 100 },
      width: 60,
      height: 40,
      label: 'ã‚«ã‚ªã‚¹1',
      output: false,
      inputs: ['']
    },
    {
      id: 'chaos_bit2',
      type: 'OUTPUT' as const,
      position: { x: 500, y: 150 },
      width: 60,
      height: 40,
      label: 'ã‚«ã‚ªã‚¹2',
      output: false,
      inputs: ['']
    },
    {
      id: 'chaos_bit3',
      type: 'OUTPUT' as const,
      position: { x: 500, y: 200 },
      width: 60,
      height: 40,
      label: 'ã‚«ã‚ªã‚¹3',
      output: false,
      inputs: ['']
    },

    // ===== è¿½åŠ ãƒ­ã‚¸ãƒƒã‚¯ã‚²ãƒ¼ãƒˆï¼ˆã‚«ã‚ªã‚¹æ€§ã‚’é«˜ã‚ã‚‹ï¼‰=====
    {
      id: 'mix_and1',
      type: 'AND' as const,
      position: { x: 350, y: 50 },
      width: 60,
      height: 60,
      label: 'AND',
      output: false,
      inputs: ['', '']
    },
    {
      id: 'mix_or1',
      type: 'OR' as const,
      position: { x: 350, y: 200 },
      width: 60,
      height: 60,
      label: 'OR',  
      output: false,
      inputs: ['', '']
    }
  ],

  wires: [
    // ã‚¯ãƒ­ãƒƒã‚¯ â†’ ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
    {
      id: 'clk_counter',
      from: { gateId: 'clock', pinIndex: -1 },
      to: { gateId: 'counter', pinIndex: 0 },
      isActive: false
    },
    
    // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å‡ºåŠ›ï¼ˆãƒ“ãƒƒãƒˆ0,1ï¼‰â†’ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯XOR
    {
      id: 'counter_b0_xor',
      from: { gateId: 'counter', pinIndex: 0 },
      to: { gateId: 'feedback_xor', pinIndex: 0 },
      isActive: false
    },
    {
      id: 'counter_b1_xor',
      from: { gateId: 'counter', pinIndex: 1 },
      to: { gateId: 'feedback_xor', pinIndex: 1 },
      isActive: false
    },

    // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å‡ºåŠ› â†’ è¿½åŠ ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚«ã‚ªã‚¹æ€§å‘ä¸Šï¼‰
    {
      id: 'counter_b0_and',
      from: { gateId: 'counter', pinIndex: 0 },
      to: { gateId: 'mix_and1', pinIndex: 0 },
      isActive: false
    },
    {
      id: 'counter_b1_and',
      from: { gateId: 'counter', pinIndex: 1 },
      to: { gateId: 'mix_and1', pinIndex: 1 },
      isActive: false
    },
    {
      id: 'counter_b0_or',
      from: { gateId: 'counter', pinIndex: 0 },
      to: { gateId: 'mix_or1', pinIndex: 0 },
      isActive: false
    },
    {
      id: 'xor_out_or',
      from: { gateId: 'feedback_xor', pinIndex: -1 },
      to: { gateId: 'mix_or1', pinIndex: 1 },
      isActive: false
    },

    // å„ç¨®å‡ºåŠ›ã¸ã®æ¥ç¶š
    {
      id: 'out_chaos0',
      from: { gateId: 'counter', pinIndex: 0 }, // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®ãƒ“ãƒƒãƒˆ0
      to: { gateId: 'chaos_bit0', pinIndex: 0 },
      isActive: false
    },
    {
      id: 'out_chaos1',
      from: { gateId: 'counter', pinIndex: 1 }, // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®ãƒ“ãƒƒãƒˆ1
      to: { gateId: 'chaos_bit1', pinIndex: 0 },
      isActive: false
    },
    {
      id: 'out_chaos2',
      from: { gateId: 'mix_and1', pinIndex: -1 }, // ANDå‡ºåŠ›
      to: { gateId: 'chaos_bit2', pinIndex: 0 },
      isActive: false
    },
    {
      id: 'out_chaos3',
      from: { gateId: 'feedback_xor', pinIndex: -1 }, // XORå‡ºåŠ›
      to: { gateId: 'chaos_bit3', pinIndex: 0 },
      isActive: false
    }
  ],

  metadata: {
    createdAt: '2025-06-20',
    author: 'Claude Code',
    version: '1.0',
    tags: ['sequential', 'chaos', 'reliable', 'simple'],
    
    // æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œãƒ‘ã‚¿ãƒ¼ãƒ³
    expectedBehavior: {
      description: 'ãƒã‚¤ãƒŠãƒªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãŒ0â†’1â†’2â†’3â†’0ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¹°ã‚Šè¿”ã—ã€å„ç¨®è«–ç†ã‚²ãƒ¼ãƒˆãŒã“ã‚Œã‚’å¤‰æ›ã—ã¦ã‚«ã‚ªã‚¹çš„ãªå‡ºåŠ›ã‚’ç”Ÿæˆ',
      outputPattern: {
        'chaos_bit0': '0â†’1â†’0â†’1â†’0... (ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼LSB)',
        'chaos_bit1': '0â†’0â†’1â†’1â†’0... (ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼MSB)', 
        'chaos_bit2': '0â†’0â†’0â†’1â†’0... (ANDçµæœ)',
        'chaos_bit3': '0â†’1â†’1â†’0â†’0... (XORçµæœ)'
      },
      frequency: '2Hzã‚¯ãƒ­ãƒƒã‚¯ã§500msæ¯ã«çŠ¶æ…‹å¤‰åŒ–'
    },

    // æŠ€è¡“çš„ãªç‰¹å¾´
    technicalFeatures: [
      'D-FFäºŒæ®µéšè©•ä¾¡ã«ä¾å­˜ã—ãªã„è¨­è¨ˆ',
      'BINARY_COUNTERã«ã‚ˆã‚‹ç¢ºå®ŸãªçŠ¶æ…‹é·ç§»',
      'å¾ªç’°ä¾å­˜ãªã—ã®å˜ç´”ãªè©•ä¾¡é †åº',
      'XORãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«ã‚ˆã‚‹æ“¬ä¼¼ãƒ©ãƒ³ãƒ€ãƒ æ€§',
      'è¦³å¯Ÿã—ã‚„ã™ã„ä½å‘¨æ³¢æ•°ï¼ˆ2Hzï¼‰å‹•ä½œ'
    ],

    // å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ
    learningPoints: [
      'ãƒã‚¤ãƒŠãƒªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®åŸºæœ¬å‹•ä½œ',
      'è«–ç†ã‚²ãƒ¼ãƒˆã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã‚‹è¤‡é›‘æ€§å‰µç™º',
      'ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚‹æ“¬ä¼¼ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ',
      'ç¢ºå®Ÿãªå›è·¯è¨­è¨ˆã®é‡è¦æ€§'
    ]
  }
};