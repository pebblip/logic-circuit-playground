<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DELAYリングオシレーター作成手順</title>
    <style>
        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
        }
        .step {
            background: #ecf0f1;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
        }
        .code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Monaco', 'Consolas', monospace;
            overflow-x: auto;
            margin: 10px 0;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #28a745;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .circuit-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎯 DELAYゲートを使ったリングオシレーター作成</h1>
        
        <div class="success">
            <strong>✅ DELAYゲートの実装は完了しています！</strong><br>
            テストで動作確認済み：パターン「11100011100011100011」の周期的発振
        </div>

        <h2>📋 ブラウザでの回路作成手順</h2>
        
        <div class="step">
            <strong>ステップ1:</strong> アプリケーションにアクセス<br>
            <a href="http://localhost:5174/" target="_blank">http://localhost:5174/</a> を開く
        </div>

        <div class="step">
            <strong>ステップ2:</strong> 開発者ツールを開く<br>
            F12キーを押すか、右クリック → 「検証」を選択
        </div>

        <div class="step">
            <strong>ステップ3:</strong> コンソールタブに切り替える
        </div>

        <div class="step">
            <strong>ステップ4:</strong> 以下のコードをコピーして実行
        </div>

        <div class="code">
// DELAYリングオシレーター回路を作成
const store = useCircuitStore.getState();

// 現在の回路をクリア
store.setState({ gates: [], wires: [] });

// リングオシレーター回路の定義
const oscillatorGates = [
  // 3つのNOTゲート（奇数個なので発振可能）
  {
    id: 'osc_not1',
    type: 'NOT',
    position: { x: 300, y: 200 },
    inputs: [''],
    output: true, // 初期状態：非対称
  },
  {
    id: 'osc_not2',
    type: 'NOT',
    position: { x: 500, y: 200 },
    inputs: [''],
    output: false,
  },
  {
    id: 'osc_not3',
    type: 'NOT',
    position: { x: 700, y: 200 },
    inputs: [''],
    output: false,
  },
  // DELAYゲート（3サイクル遅延）
  {
    id: 'osc_delay1',
    type: 'DELAY',
    position: { x: 500, y: 350 },
    inputs: [''],
    output: false,
    metadata: { history: [] },
  },
  // 出力確認用
  {
    id: 'osc_output1',
    type: 'OUTPUT',
    position: { x: 300, y: 100 },
    inputs: [''],
    output: false,
  },
];

const oscillatorWires = [
  // not1 -> not2
  {
    id: 'osc_w1',
    from: { gateId: 'osc_not1', pinIndex: -1 },
    to: { gateId: 'osc_not2', pinIndex: 0 },
    isActive: false,
  },
  // not2 -> not3
  {
    id: 'osc_w2',
    from: { gateId: 'osc_not2', pinIndex: -1 },
    to: { gateId: 'osc_not3', pinIndex: 0 },
    isActive: false,
  },
  // not3 -> delay1
  {
    id: 'osc_w3',
    from: { gateId: 'osc_not3', pinIndex: -1 },
    to: { gateId: 'osc_delay1', pinIndex: 0 },
    isActive: false,
  },
  // delay1 -> not1 (フィードバックループ)
  {
    id: 'osc_w4',
    from: { gateId: 'osc_delay1', pinIndex: -1 },
    to: { gateId: 'osc_not1', pinIndex: 0 },
    isActive: false,
  },
  // not1 -> output1 (発振確認用)
  {
    id: 'osc_w5',
    from: { gateId: 'osc_not1', pinIndex: -1 },
    to: { gateId: 'osc_output1', pinIndex: 0 },
    isActive: false,
  },
];

// 回路を設定
store.setState({ 
  gates: oscillatorGates, 
  wires: oscillatorWires 
});

console.log('🎯 DELAYリングオシレーター回路が作成されました！');
        </div>

        <h2>🔄 回路の動作原理</h2>
        
        <div class="circuit-info">
            <h3>リングオシレーターの仕組み</h3>
            <ul>
                <li><strong>NOT1 → NOT2 → NOT3 → DELAY → NOT1</strong> の順に信号が回る</li>
                <li><strong>奇数個のNOT</strong>（3個）により論理反転のループを形成</li>
                <li><strong>DELAYゲート</strong>が3サイクルの遅延を提供</li>
                <li><strong>非対称な初期状態</strong>（NOT1=true, 他=false）で発振開始</li>
            </ul>
        </div>

        <h2>📊 期待される動作</h2>
        
        <div class="step">
            <strong>発振パターン:</strong> 111 → 000 → 111 → 000 → ... (3ビット周期)
        </div>
        
        <div class="step">
            <strong>OUTPUTゲートの表示:</strong> 緑（ON）と灰色（OFF）の交互点滅
        </div>

        <div class="warning">
            <strong>注意:</strong> 全てのゲートが0の状態では発振しません。非対称な初期状態が重要です。
        </div>

        <h2>🎮 手動確認方法</h2>
        
        <div class="step">
            1. 上記コードで回路を作成後、OUTPUTゲートの状態を観察
        </div>
        
        <div class="step">
            2. シミュレーションが自動実行され、発振パターンが確認できます
        </div>
        
        <div class="step">
            3. DELAYゲートの履歴インジケーター（3つの丸）で遅延状態も確認可能
        </div>

        <div class="success">
            <strong>🎉 成功！</strong> これで真のセルフオシレーティング回路の完成です。
        </div>
    </div>
</body>
</html>